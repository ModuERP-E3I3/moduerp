<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BillingInfoMapper">

	<!-- resultMap: BILLING_INFO 테이블과 BillingInfoDTO 매핑 -->
	<resultMap id="BillingInfoResultMap"
		type="com.e3i3.moduerp.billingInfo.model.dto.BillingInfoDTO">
		<id property="cardBillingId" column="CARD_BILLING_ID" />
		<result property="customerKey" column="CUSTOMER_KEY" />
		<result property="billingKey" column="BILLING_KEY" />
		<result property="cardCompany" column="CARD_COMPANY" />
		<result property="cardNumber" column="CARD_NUMBER" />
		<result property="cardType" column="CARD_TYPE" />
		<result property="ownerType" column="OWNER_TYPE" />
		<result property="issuerCode" column="ISSUER_CODE" />
		<result property="acquirerCode" column="ACQUIRER_CODE" />
		<result property="authenticatedAt" column="AUTHENTICATED_AT" />
		<result property="createdAt" column="CREATED_AT" />
		<result property="bizNumber" column="BIZ_NUMBER" />
	</resultMap>

	<!-- BillingInfoDTO 데이터를 DB에 저장하는 insert 쿼리 -->
	<insert id="insertBillingInfo"
		parameterType="com.e3i3.moduerp.billingInfo.model.dto.BillingInfoDTO">
		INSERT INTO BILLING_INFO (
		CARD_BILLING_ID, CUSTOMER_KEY,
		BILLING_KEY, CARD_COMPANY,
		CARD_NUMBER, CARD_TYPE, OWNER_TYPE,
		ISSUER_CODE,
		ACQUIRER_CODE, AUTHENTICATED_AT, CREATED_AT, BIZ_NUMBER
		)
		VALUES (
		#{cardBillingId}, #{customerKey}, #{billingKey},
		#{cardCompany},
		#{cardNumber}, #{card.cardType}, #{card.ownerType},
		#{card.issuerCode},
		#{card.acquirerCode}, #{authenticatedAt},
		#{createdAt}, #{bizNumber}
		)
	</insert>


	<select id="selectBillingInfoData" parameterType="String"
		resultType="com.e3i3.moduerp.billingInfo.model.dto.BillingInfoDTO">
		SELECT *
		FROM BILLING_INFO
		WHERE BIZ_NUMBER = #{bizNumber}
	</select>

	<select id="selectBillingInfoByBizNumbers"
		resultType="com.e3i3.moduerp.billingInfo.model.dto.BillingInfoDTO">
		SELECT *
		FROM BILLING_INFO
		WHERE BIZ_NUMBER IN
		<foreach item="bizNumber" collection="list" open="("
			separator="," close=")">
			#{bizNumber}
		</foreach>
	</select>

</mapper>
